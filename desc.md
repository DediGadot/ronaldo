# Project: BMW E28 Parts Scraper & Display

## Overall Goal

This project is a web application designed to scrape BMW E28 classic car parts from eBay, process the data, and display it in a clean, user-friendly interface. The backend is built with Python (FastAPI) and the frontend is a modern React application.

## Key Technologies

- **Backend:**
  - **Framework:** FastAPI
  - **Database:** SQLite with SQLAlchemy
  - **Web Scraping:** Scrapy
  - **Translation & Content Generation:** Google Gemini API (`google-generativeai`)
  - **Web Search:** SerpApi (`google-search-results`)

- **Frontend:**
  - **Framework:** React with Vite
  - **Styling:** CSS

- **Deployment:**
  - **Containerization:** Docker

## Project Structure

```
/
├── app/
│   ├── __init__.py
│   ├── api.py          # FastAPI application endpoints
│   ├── crud.py         # Database create, read, update, delete operations
│   ├── database.py     # SQLAlchemy database setup
│   ├── main.py         # Main FastAPI application entrypoint
│   ├── models.py       # SQLAlchemy database models
│   ├── pipelines.py    # Scrapy item processing pipelines
│   ├── schemas.py      # Pydantic schemas for API data validation
│   └── spiders/
│       └── ebay_spider.py # Scrapy spider for eBay
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   └── PartCard.jsx  # React component for a single part
│   │   └── App.jsx         # Main React application component
│   └── vite.config.js  # Vite configuration for proxying API requests
├── static/             # Serves the built React frontend
├── tests/
│   └── test_api.py     # Pytest tests for the API
├── Dockerfile          # Dockerfile for building and deploying the application
├── prompts.yaml        # Prompts and model configuration for the Gemini API
├── requirements.txt    # Python dependencies
├── run_app.sh          # Script to run the application locally
└── update_descriptions.py # Script to enrich part descriptions using AI
```

## Backend Details

### Database

- The application uses a simple SQLite database file (`e28_parts.db`).
- The database schema is defined in `app/models.py` using SQLAlchemy and includes fields for the part's title (English and Hebrew), price, image URL, eBay URL, and detailed descriptions.

### Web Scraping

- A Scrapy spider in `app/spiders/ebay_spider.py` scrapes the eBay search results page for "BMW E28 parts".
- It extracts the title, price, image URL, and a link to the product page for each item.
- Placeholder descriptions are generated by the spider.

### Data Enrichment & Translation

- The `update_descriptions.py` script enriches the scraped data.
- It uses the Gemini API (`gemini-1.5-flash-latest`) to generate detailed, high-quality Hebrew descriptions for each part.
- The prompt used for this is stored in `prompts.yaml`.

### API

- The API is built with FastAPI and is defined in `app/api.py`.
- It provides two main endpoints:
  - `GET /api/parts/`: Returns a list of all parts.
  - `GET /api/parts/{part_id}`: Returns a single part by its ID.
- The API serves the static frontend files from the `static/` directory.

## Frontend Details

- The frontend is a single-page application built with React and Vite.
- The main component, `App.jsx`, fetches data from the backend API and displays it in a grid.
- The `PartCard.jsx` component renders the details for each individual part, including the Hebrew description.
- The frontend uses a proxy in `vite.config.js` to forward API requests to the FastAPI backend during development.

## How to Run the Application

### 1. Locally

The `run_app.sh` script is the easiest way to run the application locally. It handles stopping old processes and starting both the backend and frontend servers.

- **To run with the default port (8000):**
  ```bash
  ./run_app.sh
  ```
- **To specify a custom port:**
  ```bash
  ./run_app.sh 8080
  ```

The frontend will be available at `http://localhost:5173`.

### 2. With Docker

A `Dockerfile` is provided to build and run the application in a container.

- **Build the image:**
  ```bash
  docker build -t e28-app .
  ```
- **Run the container:**
  ```bash
  docker run -p 8000:8000 e28-app
  ```

The application will be available at `http://localhost:8000`.
